<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <style>
        #title {
            margin-top: 100px;
        }
        table {
            border-collapse: collapse;
            border-spacing: 0;
            width: 100%;
            border: 1px solid #ddd;
        }

        th, td {
            text-align: left;
            padding: 8px;

        }

        tr:nth-child(even){background-color: #f2f2f2}
        tr {
            height: 30px;
        }

    </style>
</head>
<body>

<div class="container">

    <div class="row" id="title">
        <div class="col-md-11">
            <h1>Dashboard</h1>
            <br>
            <h2> Records (Number: <%= quotes.length %>) </h2>
            <!--            <h4>  </h4>-->
        </div>
        <div class="col-md-1">
            <button id="back">Back</button>
        </div>
    </div>
    <br>
    <div>

    </div>
    <br>
    <div class="row">
        <div class="col-md-12" id="data">
            <div style="overflow-x:auto;">
                <table>
                    <tr>
                        <th>No.</th>
                        <th>ParticipantID</th>
                        <th>StartTime</th>
                        <th>EndTime</th>
                        <th>Age</th>
                        <th>Sex</th>
                        <th>Degree</th>
                        <th>Monitor</th>
                        <th>Q1</th>
                        <th>Q2</th>
                        <th>Q3</th>
                        <th>Q4</th>
                        <th>Q5</th>
                        <th>Q6</th>
                        <th>Q7</th>
                        <th>Q8</th>
                        <th>Q9</th>
                        <th>Q10</th>
                        <th>Delete</th>

                    </tr>
                    <% for(var i = 0; i < quotes.length; i++) {%>
                        <tr class = "quote">

                            <th><%= i+1%></th>
                            <th><%= quotes[i].participantId%></th>
                            <th><%= quotes[i].starttime%></th>
                            <th><%= quotes[i].endtime%></th>
                            <th><%= quotes[i].age%></th>
                            <th><%= quotes[i].sex%></th>
                            <th><%= quotes[i].degree%></th>
                            <th><%= quotes[i].monitor%></th>
                            <th><%= quotes[i].q1%></th>
                            <th><%= quotes[i].q2%></th>
                            <th><%= quotes[i].q3%></th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th class="delete-button" data-id="<%= quotes[i].participantId%>">Delete</th>
                        </tr>
                    <% }%>

                </table>
            </div>
            <!--            <ul class = "quotes">-->
            <!--                <% for(var i = 0; i < quotes.length; i++) {%>-->
            <!--                    <li class = "quote">-->
            <!--                        <span><%= quotes[i].participantId%></span>:-->
            <!--                        <span><%= quotes[i].starttime%></span>,-->
            <!--                        <span><%= quotes[i].age%></span>,-->
            <!--                        <span><%= quotes[i].sex%></span>,-->
            <!--                        <span><%= quotes[i].degree%></span>-->
            <!--                        <button class="delete-button" data-id="<%= quotes[i].partcipantId%>">Delete</button>-->
            <!--                    </li>-->
            <!--                <% }%>-->
            <!--            </ul>-->
        </div>
    </div>

</div>

<!--<form action="/quotes" method="POST">-->
<!--    <input type="text" placeholder="name" name="name">-->
<!--    <input type="text" placeholder="quote" name="quote">-->
<!--    <button type="submit">Submit</button>-->
<!--</form>-->
<script src="/jquery/jquery.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>


<script>
    var elements = document.getElementsByClassName("delete-button");

    var deleteFunction = function(event) {
        //console.log("click")
        //console.log(event)
        console.log(event.target.getAttribute("data-id"))
        //console.log(event.target.attributes.data)
        const theID = event.target.getAttribute("data-id");
        fetch("/dashboard", {
            method: 'delete',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                participantId: theID
            })
        })
            .then(res => {
                if (res.ok) return res.json()
            })
            .then(data => {
                window.location.reload()
            })
    }

    for(var i = 0; i < elements.length; i++) {
        elements[i].addEventListener("click", deleteFunction, false)
    }

    document.getElementById("back").addEventListener("click", () => {
        window.location.href="../index.html"
    })
</script>

<!--<script src="/public/modules/dashboard/index.js"></script>-->
</body>


</html>